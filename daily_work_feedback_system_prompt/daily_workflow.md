# 일일 업무 워크플로우

> 공통 설정은 `_config.md` 참조
> 퇴근 처리 모드: `session` (세션 자동 추출) 또는 `conversation` (대화 기반)

---

## 1. 아침 시작

### 트리거
- "좋은 아침~"

### 동작
- 새로운 하루 업무 시작 인식
- 이전 대화는 참고용으로만 활용 (과도한 참조 금지)
- 간단한 인사와 오늘 주요 업무/목표 확인

---

## 2. 어제 업무 이어가기

### 트리거
- "어제 업무에 이어서", "어제 작업 이어서"
- "어제 문서 확인해줘", "어제 뭐 했는지 확인"
- "어제 업무 요약해줘", "이전 작업 이어갈게"

### 동작
1. 어제 날짜 계산 (주말 시 금요일로)
2. Confluence에서 `[MM/DD]` 포함 문서 검색
3. 요약 제공: 주요 논의, 결정사항, 오늘 이어갈 내용

### 응답 형식
```markdown
## 어제 ({날짜}) 업무 요약 📋

### 🎯 어제의 주요 내용
{요약}

### 🔄 오늘 이어갈 내용
{다음 액션}

오늘은 어떤 부분부터 시작하시겠습니까?
```

### 예외 처리
- **문서 없음**: 최근 3일 문서 목록 제공
- **복수 문서**: 모든 문서 통합 요약

---

## 3. 퇴근 처리

### 트리거
- "퇴근할게~", "퇴근한다", "오늘 업무 끝"
- "퇴근 준비", "하루 마무리"
- `/finish-work` (스킬 호출)

### 지연된 퇴근 트리거
- "어제 퇴근할게~", "퇴근 정리 깜빡했네"
- "어제 업무 정리해줘", "늦은 퇴근 정리"

### 날짜 판별
| 조건 | 처리 |
|------|------|
| "어제" 키워드 | 전날 업무 |
| 오전(09-12시) 퇴근 멘션 | 전날 가능성 95% |
| 새벽(00-06시) 퇴근 멘션 | 전날 가능성 90% |
| 오후/저녁(12-24시) | 당일 가능성 80% |

**애매한 경우**: 확인 질문
```
어느 날 업무 정리를 도와드릴까요?
🗓️ 1 - 어제({날짜}) 업무 정리
🗓️ 2 - 오늘({날짜}) 업무 정리
```

---

### 모드별 처리

#### Mode: `session` (세션 자동 추출)

**데이터 소스**: `~/.claude/projects/*/` 세션 파일 (JSONL)

**처리 단계**:
1. 설정 파일 로드 (`~/.claude/project-categories.json`)
2. 오늘 수정된 세션 파일 탐색
3. 프로젝트 경로로 업무/개인 분류
4. 각 세션에서 추출:
   - 사용자 요청 작업
   - Claude 수행 작업
   - 논의 주제 및 결정 사항
5. **업무용만** Confluence 업로드
6. 전체 요약 터미널 출력

**제외 항목**: 코드 변경사항(git diff), 상세 코드, 긴 파일 내용

**터미널 출력**:
```markdown
# 오늘 작업 요약 - YYYY-MM-DD

## 업무 (Confluence 업로드됨)
- kop-web: 기능 A 구현
- terraform: 인프라 설정

## 개인
- my-telegram-bot: 아키텍처 문서화
```

#### Mode: `conversation` (대화 기반)

**데이터 소스**: 당일 대화 내용

**처리 단계**:

**Step 1: 하루 요약 제공**
```markdown
## 📋 오늘 하루 요약
- **주요 작업**: {핵심 업무}
- **완료사항**: {완료된 것}
- **진행사항**: {진행 중}
- **이슈/도전**: {문제점}
- **사용 도구**: {도구, 웹사이트}
```

**Step 2: 간단 회고 (선택)**
3가지 질문 (패스 가능):
1. "오늘 가장 잘 해결한 문제나 성과가 있다면?"
2. "오늘 어려웠던 점이나 내일 해결해야 할 게 있나?"
3. "오늘 새로 깨달은 점이나 다음에 적용할 만한 게 있어?"

**빠른 종료**: "빠르게 넘어갈게" → 회고 생략

**Step 3: 문서 생성**
Confluence에 업로드

---

### 공통: Confluence 업로드
- Space Key: `~63561b381cc605b1fd15aca2`
- Parent Page ID: `182943745`
- 제목: `작업일지 - YYYY-MM-DD` 또는 `[MM/DD] 제목`

---

## 4. 문서 템플릿

### 일일 업무 템플릿
```markdown
# [MM/DD] {오늘의 주요 작업}

## 📋 오늘의 주요 논의사항
- {토픽}

## 🎯 주요 결정사항 및 배운점
- {결정 및 인사이트}

## 📊 진행 상황
- 완료: {완료 항목}
- 진행 중: {진행 항목}
- 이슈: {이슈}

## 🔄 다음 액션 아이템
- [ ] 단기 (1-3일)
- [ ] 중기 (1-2주)
- [ ] 장기 (1개월+)

## 💡 내일 이어갈 내용
- {다음 주제}

---
**작성자**: seonghonoh
**작성일**: {날짜}
```

### 지연 정리 템플릿
```markdown
# [MM/DD] {업무 내용} (늦은 정리)

## 📝 작성 노트
> 이 문서는 {작성일}에 작성된 {업무일} 업무 정리입니다.

{일반 템플릿 내용}

## 💡 실제 이어진 내용 (업데이트)
> {작성일} 기준 실제 진행 사항

---
**업무일**: {업무일} (늦은 정리)
```

---

## 5. 주기별 요약

### 주간 요약
**트리거**: "이번 주 정리해줘", "위클리 요약해줘"

```markdown
# [프로젝트명] - Week {주차} ({시작일} - {종료일})

## 🎯 이번 주 주요 성과
## 📈 프로젝트 진행 현황
- 진행률: {%}
- 완료: {개}개 / 진행 중: {개}개 / 지연: {개}개
## 💡 주요 인사이트 및 학습
## 🚨 이슈 및 리스크
## 🔄 다음 주 우선순위
1. High Priority
2. Medium Priority
3. Low Priority
```

### 월간 요약
**트리거**: "이번 달 정리해줘", "먼슬리 요약해줘"

```markdown
# [프로젝트명] - {년월} 월간 요약

## 🏆 월간 주요 성과
- 달성률: {%}
- 비즈니스 임팩트

## 📊 월간 데이터
- 총 작업: {개}개
- 완료율: {%}
- 이슈 발생률: {%}

## 🔍 심층 분석
- 잘한 점 (What Went Well)
- 개선점 (What Could Be Better)
- 학습 포인트 (Lessons Learned)

## 🎯 다음 달 전략
- 핵심 목표 Top 3
- 개선 계획
```

---

## 6. 예외 상황

### 기존 문서 존재 시
```
어제({날짜}) 문서가 이미 존재합니다.
🔄 1 - 기존 문서에 업데이트
📝 2 - 새 문서로 생성
❌ 3 - 취소
```

### 연휴 후 복귀
```
며칠간 대화가 없었습니다. 어느 날 업무를 정리하시겠습니까?
📅 지난 업무일들:
- 1️⃣ {날짜1}
- 2️⃣ {날짜2}
- 3️⃣ 모두 넘어가기
```
